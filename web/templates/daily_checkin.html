{% extends "base.html" %}

{% block title %}Daily Mood & Sleep Check-In - Materna Minds{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="page-header mb-4">
        <h2>Daily Mood & Sleep Check-In</h2>
        <p class="text-muted">Takes less than 1 minute. Your daily check-in helps us track patterns and support you early.</p>
        <a href="{% url 'home' %}" class="back-link">‚Üê Back to Home</a>
    </div>

    {% if messages %}
        <div class="messages">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}

    <div class="card shadow-sm">
        <div class="card-body">
            <form method="post" id="dailyCheckinForm">
                {% csrf_token %}

                <!-- Mood Rating -->
                <div class="mb-4">
                    <label class="form-label fw-bold">üí¨ How are you feeling today?</label>
                    <p class="text-muted small">On a scale of 1‚Äì10: 1 = Very low, 10 = Very positive</p>

                    <div class="mood-scale">
                        <div class="d-flex justify-content-between mb-2">
                            {% for i in "12345678910" %}
                            <label class="mood-option">
                                <input type="radio" name="mood_rating" value="{{ forloop.counter }}" required>
                                <span class="mood-number">{{ forloop.counter }}</span>
                            </label>
                            {% endfor %}
                        </div>
                        <div class="d-flex justify-content-between">
                            <small class="text-muted">Very Low</small>
                            <small class="text-muted">Very Positive</small>
                        </div>
                    </div>
                </div>

                <!-- Optional Mood Description -->
                <div class="mb-4">
                    <label class="form-label fw-bold">Describe your mood in a few words (Optional)</label>
                    <input type="text" name="mood_description" class="form-control" placeholder="e.g., Tired but hopeful, Anxious, Content">
                </div>

                <!-- Sleep Hours -->
                <div class="mb-4">
                    <label class="form-label fw-bold">üò¥ How much sleep did you get last night?</label>
                    <p class="text-muted small">Total hours of sleep:</p>

                    <div class="btn-group w-100" role="group">
                        <input type="radio" class="btn-check" name="hours_of_sleep" id="sleep1" value="less_than_3" required>
                        <label class="btn btn-outline-primary" for="sleep1">Less than 3</label>

                        <input type="radio" class="btn-check" name="hours_of_sleep" id="sleep2" value="3_4">
                        <label class="btn btn-outline-primary" for="sleep2">3‚Äì4</label>

                        <input type="radio" class="btn-check" name="hours_of_sleep" id="sleep3" value="4_5">
                        <label class="btn btn-outline-primary" for="sleep3">4‚Äì5</label>

                        <input type="radio" class="btn-check" name="hours_of_sleep" id="sleep4" value="5_6">
                        <label class="btn btn-outline-primary" for="sleep4">5‚Äì6</label>

                        <input type="radio" class="btn-check" name="hours_of_sleep" id="sleep5" value="more_than_6">
                        <label class="btn btn-outline-primary" for="sleep5">More than 6</label>
                    </div>
                </div>

                <!-- Baby's Sleep Pattern (Optional) -->
                <div class="mb-4">
                    <label class="form-label fw-bold">üçº Baby's Sleep Pattern (Optional)</label>
                    <p class="text-muted small">How many times did your baby wake during the night?</p>

                    <div class="btn-group w-100" role="group">
                        <input type="radio" class="btn-check" name="baby_wake_count" id="wake1" value="0_1">
                        <label class="btn btn-outline-secondary" for="wake1">0‚Äì1</label>

                        <input type="radio" class="btn-check" name="baby_wake_count" id="wake2" value="2_3">
                        <label class="btn btn-outline-secondary" for="wake2">2‚Äì3</label>

                        <input type="radio" class="btn-check" name="baby_wake_count" id="wake3" value="4_5">
                        <label class="btn btn-outline-secondary" for="wake3">4‚Äì5</label>

                        <input type="radio" class="btn-check" name="baby_wake_count" id="wake4" value="6_plus">
                        <label class="btn btn-outline-secondary" for="wake4">6+</label>
                    </div>
                </div>

                <!-- Energy Level -->
                <div class="mb-4">
                    <label class="form-label fw-bold">‚ö° Energy Level Today</label>
                    <p class="text-muted small">How would you rate your energy?</p>

                    <select name="energy_level" class="form-select" required>
                        <option value="">Select energy level...</option>
                        <option value="very_low">Very low</option>
                        <option value="low">Low</option>
                        <option value="moderate">Moderate</option>
                        <option value="good">Good</option>
                        <option value="high">High</option>
                    </select>
                </div>

                <!-- Stress Level -->
                <div class="mb-4">
                    <label class="form-label fw-bold">üòü Stress Level Today</label>

                    <select name="stress_level" class="form-select" required>
                        <option value="">Select stress level...</option>
                        <option value="calm">Calm</option>
                        <option value="slightly_stressed">Slightly stressed</option>
                        <option value="moderately_stressed">Moderately stressed</option>
                        <option value="very_stressed">Very stressed</option>
                        <option value="overwhelmed">Overwhelmed</option>
                    </select>
                </div>

                <!-- Intrusive Thoughts -->
                <div class="mb-4">
                    <label class="form-label fw-bold">üí≠ Any intrusive or distressing thoughts today?</label>

                    <select name="intrusive_thoughts" class="form-select" required>
                        <option value="">Select...</option>
                        <option value="no">No</option>
                        <option value="mild">Mild</option>
                        <option value="moderate">Moderate</option>
                        <option value="severe">Severe</option>
                    </select>

                    <div id="intrusiveAlert" class="alert alert-warning mt-3" style="display: none;">
                        <strong>You're not alone.</strong> If these thoughts feel hard to manage, consider reaching out to someone you trust or a healthcare professional.
                    </div>
                </div>

                <!-- Notes -->
                <div class="mb-4">
                    <label class="form-label fw-bold">üìù Notes (Optional)</label>
                    <p class="text-muted small">Anything else you'd like to share today?</p>
                    <textarea name="notes" class="form-control" rows="3" placeholder="Optional notes..."></textarea>
                </div>

                <!-- Submit Button -->
                <div class="d-grid gap-2">
                    <button type="submit" class="btn btn-primary btn-lg">Submit Today's Check-In</button>
                    <a href="{% url 'home' %}" class="btn btn-outline-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Thank You Message -->
    <div class="alert alert-info mt-4">
        <strong>üåø Thank you for checking in!</strong><br>
        Small daily steps help us understand your patterns and support you better.
    </div>
</div>

<style>
.mood-scale {
    padding: 1rem;
    background-color: #f8f9fa;
    border-radius: 8px;
}

.mood-option {
    cursor: pointer;
    margin: 0;
}

.mood-option input[type="radio"] {
    display: none;
}

.mood-number {
    display: inline-block;
    width: 40px;
    height: 40px;
    line-height: 40px;
    text-align: center;
    border: 2px solid #dee2e6;
    border-radius: 50%;
    font-weight: 600;
    transition: all 0.2s;
}

.mood-option input[type="radio"]:checked + .mood-number {
    background-color: #0d6efd;
    color: white;
    border-color: #0d6efd;
}

.mood-option:hover .mood-number {
    border-color: #0d6efd;
    transform: scale(1.1);
}

@media (max-width: 768px) {
    .mood-number {
        width: 32px;
        height: 32px;
        line-height: 32px;
        font-size: 0.9rem;
    }

    .btn-group {
        flex-direction: column;
    }

    .btn-group label {
        border-radius: 0.375rem !important;
        margin-bottom: 0.5rem;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const intrusiveSelect = document.querySelector('select[name="intrusive_thoughts"]');
    const intrusiveAlert = document.getElementById('intrusiveAlert');

    intrusiveSelect.addEventListener('change', function() {
        if (this.value === 'moderate' || this.value === 'severe') {
            intrusiveAlert.style.display = 'block';
        } else {
            intrusiveAlert.style.display = 'none';
        }
    });
});
</script>
{% endblock %}
